<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Sum of squares type I, II, and III</title>
    <meta name="author" content="Daniel Wollschlaeger">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="http://dwoll.de/rexrepos/content/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="http://dwoll.de/rexrepos/content/assets/css/style.css" rel="stylesheet" type="text/css" media="all">
    <link href="http://dwoll.de/rexrepos/content/assets/css/syntax.css" rel="stylesheet" type="text/css" media="all">
  </head>

  <body>
    <!-- ### navbar include starts ### -->
    <nav class="navbar navbar-expand-md fixed-top bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="http://dwoll.de/rexrepos/index.html">RExRepos</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      
    
      <!-- Everything you want hidden at 940px or less, place within here -->
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown0" role="button" aria-expanded="false">R Basics</a>
            <div class="dropdown-menu" aria-labelledby="dropdown0">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerR_Basics.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/gui.html">R user interfaces</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/helpDocs.html">Getting help and documentation</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/workspace.html">Exploring the workspace</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/packages.html">Add-on packages</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/arithmeticLogic.html">Arithmetic and logic</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/vector.html">Vectors</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/generateData.html">Generate systematic and random data</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/transformData.html">Variable transformations</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/recode.html">Recode variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/factors.html">Factors</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/sets.html">Sets</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/combinatorics.html">Combinatorics</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/matrix.html">Matrices</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/strings.html">Character strings</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/timeDate.html">Time and date</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown1" role="button" aria-expanded="false">Descriptive</a>
            <div class="dropdown-menu" aria-labelledby="dropdown1">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerDescriptive.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/sumProdRange.html">Sum, product, and range of data</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/mean.html">The mean and other location measures</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/variance.html">Variance, robust spread measures, skewness, and kurtosis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/correlation.html">Covariance, correlation, association for continuous variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/matrixStatistics.html">Descriptive statistics for data in matrices</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/frequencies.html">Frequency tables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/association.html">Association for unordered categorical variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/associationOrder.html">Association for ordered categorical variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/interRaterICC.html">Inter-rater-reliability and intra-class-correlation</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/aggregate.html">Aggregate data vectors by group</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/missingData.html">Deal with missing data</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown2" role="button" aria-expanded="false">Data Frames</a>
            <div class="dropdown-menu" aria-labelledby="dropdown2">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerData_Frames.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dataFrames.html">Create and analyze data frames</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfImportExport.html">Data import and export</a>
                  
                    <div class="nav-header">Data wrangling base R</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfTransform.html">Choose names, variables, cases</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfSplitMerge.html">Split and combine data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfReshape.html">Reshape data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfAggregate.html">Aggregate data frames</a>
                    
                    <div class="nav-header">Data wrangling dplyr tidyr</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfTransform_tidy.html">Choose names, variables, cases</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfSplitMerge_tidy.html">Split and combine data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfReshape_tidy.html">Reshape data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfAggregate_tidy.html">Aggregate data frames</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown active">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown3" role="button" aria-expanded="false">Univariate</a>
            <div class="dropdown-menu" aria-labelledby="dropdown3">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerUnivariate.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <div class="nav-header">Regression Models</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regression.html">Multiple linear regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionRobPen.html">Robust and penalized regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionModMed.html">Moderation and mediation</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionLogistic.html">Logistic regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionOrdinal.html">Ordinal regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionMultinom.html">Multinomial regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionPoisson.html">Poisson regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/logLinear.html">Log-linear models</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionDiag.html">Regression diagnostics</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/crossvalidation.html">Crossvalidation</a>
                    
                    <div class="nav-header">Survival analysis</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/survivalKM.html">Kaplan-Meier-estimate</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/survivalCoxPH.html">Cox proportional hazards</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/survivalParametric.html">Parametric proportional hazards</a>
                    
                    <div class="nav-header">t Tests</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/tTest.html">t-tests</a>
                    
                    <div class="nav-header">ANOVA</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaCRp.html">One-way ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaCRFpq.html">Two-way ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/ancova.html">Analysis of covariance</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaRBp.html">One-way repeated-measures ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaRBFpq.html">Two-way repeated-measures ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaSPFpq.html">Two-way split-plot ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaSPFpqr.html">Three-way split-plot ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaMixed.html">Mixed effects models</a>
                    
                      <a class="dropdown-item active" href="http://dwoll.de/rexrepos/posts/anovaSStypes.html">Sum of squares type I, II, and III</a>
                    
                    <div class="nav-header">General Topics</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/normality.html">Assess normality</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/varianceHom.html">Assess variance homogeneity</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown4" role="button" aria-expanded="false">Nonparametric</a>
            <div class="dropdown-menu" aria-labelledby="dropdown4">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerNonparametric.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <div class="nav-header">Classical nonparametric tests</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npWilcoxon.html">Location 1,2 groups (Sign, Wilcoxon signed-rank, Wilcoxon-Mann-Whitney)</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npKruskalFriedman.html">Location 3+ groups (Kruskal-Wallis, linear-by-linear, Friedman, Page)</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npBinomial.html">Binomial and chi^2 for proportions</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npRuns.html">Runs</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/association.html">Association for unordered categorical variables</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/associationOrder.html">Association for ordered categorical variables</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npCochran.html">Cochran-Q</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npBowker.html">Bowker</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npMcNemar.html">McNemar</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npStuartMaxwell.html">Stuart-Maxwell for marginal homogeneity</a>
                    
                    <div class="nav-header">Resampling methods</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingPerm.html">Permutation tests</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBoot.html">Nonparametric bootstrapping</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBootStrat.html">Stratified nonparametric bootstrapping</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBootALM.html">Nonparametric bootstrapping linear models</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBootParam.html">Parametric bootstrapping</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown5" role="button" aria-expanded="false">Multivariate</a>
            <div class="dropdown-menu" aria-labelledby="dropdown5">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerMultivariate.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/linearAlgebra.html">Linear algebra calculations</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multPCA.html">Principal components analysis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multFA.html">Factor analysis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multFApoly.html">Factor analysis for ordinal data</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multMDS.html">Multidimensional scaling</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multRegression.html">Multivariate multiple regression</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multHotelling.html">Hotelling's T^2-test</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multMANOVA.html">Multivariate analysis of variance</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multLDA.html">Linear discriminant analysis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/normality.html">Assess multivariate normality</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown6" role="button" aria-expanded="false">Diagrams</a>
            <div class="dropdown-menu" aria-labelledby="dropdown6">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerDiagrams.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <div class="nav-header">Diagram basics</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagDevice.html">Graphics devices</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagScatter.html">Scatter plots and line diagrams</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagFormat.html">Customize diagrams: Formatting</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagAddElements.html">Customize diagrams: Add elements</a>
                    
                    <div class="nav-header">Specific diagrams</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagCategorical.html">Diagrams for categorical data</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagDistributions.html">Visualize univariate and bivariate distributions</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagMultivariate.html">Diagrams for multivariate data</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagBounding.html">Convex hull, (minimum) bounding box, minimum enclosing ellipse, and minimum enclosing circle</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagSplines.html">Linear interpolation, polynomial smoothing, and splines</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagMultiple.html">Multiple diagrams per graphics device</a>
                    
                    <div class="nav-header">Diagrams ggplot2</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagGgplot_types.html">Diagram types with the ggplot2 package</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagGgplot_aes.html">Color, line type, and point shape in ggplot2 diagrams</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagGgplot_format.html">Format ggplot2 diagrams</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown7" role="button" aria-expanded="false">Numerical</a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown7">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerNumerical.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/numRoot.html">Root finding</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/numIntegrate.html">Numerical integration and differentiation</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/numOptimize.html">Numerical optimization</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
        </ul>
        <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown8" role="button" aria-expanded="false">Workflow</a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown8">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerWorkflow.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/rerWorkflowJN.html">Build websites with R and nanoc or Jekyll</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/rerWorkflowWP.html">Build websites with R and WordPress</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
        </ul>
      </div> <!-- /navbar-collapse -->
    </div> <!-- /container-fluid -->
    </nav>
    <!-- ### navbar include ### ends -->

    <div class="container-fluid" id="top">
      <div class="row">
      <!-- ### top include ends ### -->

        <div class="col-sm-4 col-md-2 dw_sidebar">
          <!-- ### rerPostList include starts ### -->

<ul class="nav flex-column">

<li class="nav-header">Regression Models</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regression.html">Multiple linear regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionRobPen.html">Robust and penalized regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionModMed.html">Moderation and mediation</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionLogistic.html">Logistic regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionOrdinal.html">Ordinal regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionMultinom.html">Multinomial regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionPoisson.html">Poisson regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/logLinear.html">Log-linear models</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionDiag.html">Regression diagnostics</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/crossvalidation.html">Crossvalidation</a></li>


<li class="nav-header">Survival analysis</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/survivalKM.html">Kaplan-Meier-estimate</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/survivalCoxPH.html">Cox proportional hazards</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/survivalParametric.html">Parametric proportional hazards</a></li>


<li class="nav-header">t Tests</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/tTest.html">t-tests</a></li>


<li class="nav-header">ANOVA</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaCRp.html">One-way ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaCRFpq.html">Two-way ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/ancova.html">Analysis of covariance</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaRBp.html">One-way repeated-measures ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaRBFpq.html">Two-way repeated-measures ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaSPFpq.html">Two-way split-plot ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaSPFpqr.html">Three-way split-plot ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaMixed.html">Mixed effects models</a></li>

<li class="nav-item"><a class="nav-link active" href="http://dwoll.de/rexrepos/posts/anovaSStypes.html">Sum of squares type I, II, and III</a></li>


<li class="nav-header">General Topics</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/normality.html">Assess normality</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/varianceHom.html">Assess variance homogeneity</a></li>


</ul>

<!-- ### rerPostList include ends ### -->

          <hr />
          <!-- ### rerCategTagList include starts ### -->
    <ul class="nav flex-column">
      <li class="dropdown-header">Tags</li>
      
      <li><ul class="nav nav-list">
        
        <li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/tags.html#ANOVA-ref">ANOVA</a></li>
        
      </ul></li>
      
    </ul>
    <!-- ### rerCategTagList include ends ### -->

        </div> <!-- /col-sm-4 col-md-2 -->

        <div class="col-sm-8 col-md-10 dw_main">
          <h1>Sum of squares type I, II, and III</h1>
          <div class="markdown-toc">
<ul><li><a href="#todo">TODO</a></li><li><a href="#install-required-packages">Install required packages</a></li><li><a href="#background">Background</a></li><li><a href="#hypotheses-for-main-effects">Hypotheses for main effects</a></li><li><a href="#data-set-with-non-proportional-unequal-cell-sizes">Data set with non-proportional unequal cell sizes</a></li><li><a href="#ss-type-i-sequential-sum-of-squares">SS type I (sequential sum of squares)</a><ul><li><a href="#factor-order-matters">Factor order matters</a></li><li><a href="#sequential-model-comparisons">Sequential model comparisons</a></li><li><a href="#total-ss-sum-of-effect-ss">Total SS <span class="math inline">\(=\)</span> sum of effect SS</a></li></ul></li><li><a href="#ss-type-ii">SS type II</a><ul><li><a href="#using-anova-from-package-car">Using <code>Anova()</code> from package <code>car</code></a></li><li><a href="#using-model-comparisons">Using model comparisons</a></li><li><a href="#total-ss-neq-sum-of-effect-ss">Total SS <span class="math inline">\(\neq\)</span> sum of effect SS</a></li></ul></li><li><a href="#ss-type-iii">SS type III</a><ul><li><a href="#using-anova-from-package-car-1">Using <code>Anova()</code> from package <code>car</code></a></li><li><a href="#model-comparisons-using-drop1">Model comparisons using <code>drop1()</code></a></li></ul></li><li><a href="#detach-automatically-loaded-packages-if-possible">Detach (automatically) loaded packages (if possible)</a></li><li><a href="#get-the-article-source-from-github">Get the article source from GitHub</a></li></ul>
</div>
<h2 id="todo">TODO</h2><ul><li>link to anovaCRFpq, ancova, multMANOVA, multRegression</li></ul><h2 id="install-required-packages">Install required packages</h2><p><a href="http://cran.r-project.org/package=car"><code>car</code></a></p><div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>wants &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;car&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>has   &lt;-<span class="st"> </span>wants <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(<span class="kw">installed.packages</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="cf">if</span>(<span class="kw">any</span>(<span class="op">!</span>has)) <span class="kw">install.packages</span>(wants[<span class="op">!</span>has])</span></code></pre></div><h2 id="background">Background</h2><p>Non-orthogonal factorial between-subjects designs typically result from non-proportional unequal cell sizes. Proportional unequal cell sizes are present when <span class="math inline">\(n_{jk}/n_{jk&#39;} = n_{j&#39;k}/n_{j&#39;k&#39;}\)</span> and <span class="math inline">\(n_{jk}/n_{j&#39;k} = n_{jk&#39;}/n_{j&#39;k&#39;}\)</span> for all <span class="math inline">\(j, j&#39;, k, k&#39;\)</span> holds.</p><p>In the non-proportional case, so-called type I, II, or III sums of squares can give different results in an ANOVA for all tests but the highest interaction effect. “Types of SS” is a misnomer: The SS of an effect is the sum of squared differences between the predicted values from the least-squares fit of a restricted model and the prediction from the least-squares fit of a more general model. What differs between the “types of SS” is the choice for the restricted and more general model when testing an effect. Orthogonal designs obscure these differences because then all SS types will be equal.</p><p>SAS and SPSS use SS type III as their default, while functions that ship with base R use type I. This can lead to different results when analyzing the same data with different statistics packages.</p><p>A thorough resource on the topic is chapter 7 of Maxwell &amp; Delaney (2004). Designing Experiments and Analyzing Data. A Model Comparison Perspective. Mahwah, NJ: Lawrence Erlbaum.</p><h2 id="hypotheses-for-main-effects">Hypotheses for main effects</h2><p>Hypotheses for main effects as tested by different SS types in a non-proportional unbalanced two-factorial between-subjects design (IV A with <span class="math inline">\(P\)</span> groups, B with <span class="math inline">\(Q\)</span> groups).</p><ul><li>Cell expected values<ul><li><span class="math inline">\(\mu_{jk} \quad 1 \leq j \leq P, \quad 1 \leq k \leq Q\)</span></li></ul></li><li>Unweighted marginal expected values:<ul><li><span class="math inline">\(\mu_{j.} := \frac{1}{Q} \sum_{k=1}^{Q} \mu_{jk} \quad 1 \leq j \leq P\)</span></li><li><span class="math inline">\(\mu_{.k} := \frac{1}{P} \sum_{j=1}^{P} \mu_{jk} \quad 1 \leq k \leq Q\)</span></li></ul></li><li>Cell sizes<ul><li><span class="math inline">\(n_{jk} \quad 1 \leq j \leq P, \quad 1 \leq k \leq Q\)</span></li></ul></li><li>Total marginal cell sizes<ul><li><span class="math inline">\(n_{j+} := \sum_{k=1}^{Q} n_{jk} \quad 1 \leq j \leq P\)</span></li><li><span class="math inline">\(n_{+k} := \sum_{j=1}^{P} n_{jk} \quad 1 \leq k \leq Q\)</span></li></ul></li></ul><p>Null-Hypotheses SS type I (A entered before B):</p><p>A: <span class="math inline">\(\sum_{k=1}^{Q} \frac{n_{1k}}{n_{1+}} \cdot \mu_{1k} = \ldots = \sum_{k=1}^{Q} \frac{n_{jk}}{n_{j+}} \cdot \mu_{jk} = \ldots = \sum_{k=1}^{Q} \frac{n_{Pk}}{n_{P+}} \cdot \mu_{Pk}\)</span></p><p>B: <span class="math inline">\(\sum_{j=1}^{P}(n_{jk} - \frac{n^{2}_{jk}}{n_{j+}}) \cdot \mu_{jk} = \sum_{k&#39; \neq k} \sum_{j=1}^{P}(\frac{n_{jk} \cdot n_{jk&#39;}}{n_{j+}}) \cdot \mu_{jk&#39;} \qquad \forall \, k = 1, \ldots, Q-1\)</span></p><p>Null-Hypotheses SS type II:</p><p>A: <span class="math inline">\(\sum_{k=1}^{Q}(n_{jk} - \frac{n^{2}_{jk}}{n_{+k}}) \cdot \mu_{jk} = \sum_{j&#39; \neq j} \sum_{k=1}^{Q}(\frac{n_{jk} \cdot n_{j&#39;k}}{n_{+k}}) \cdot \mu_{j&#39;k} \qquad \forall \, j = 1, \ldots, P-1\)</span></p><p>B: <span class="math inline">\(\sum_{j=1}^{P}(n_{jk} - \frac{n^{2}_{jk}}{n_{j+}}) \cdot \mu_{jk} = \sum_{k&#39; \neq k} \sum_{j=1}^{P}(\frac{n_{jk} \cdot n_{jk&#39;}}{n_{j+}}) \cdot \mu_{jk&#39;} \qquad \forall \,k = 1, \ldots, Q-1\)</span></p><p>Null-Hypotheses SS type III (with effect- or orthogonal coding method):</p><p>A: <span class="math inline">\(\mu_{1.} = \ldots = \mu_{j.} = \ldots = \mu_{P.}\)</span> B: <span class="math inline">\(\mu_{.1} = \ldots = \mu_{.k} = \ldots = \mu_{.Q}\)</span></p><h2 id="data-set-with-non-proportional-unequal-cell-sizes">Data set with non-proportional unequal cell sizes</h2><div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a>P    &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>Q    &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>g11  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">43</span>, <span class="dv">50</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>g12  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">51</span>, <span class="dv">43</span>, <span class="dv">53</span>, <span class="dv">54</span>, <span class="dv">46</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>g13  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">60</span>, <span class="dv">58</span>, <span class="dv">62</span>, <span class="dv">62</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>g21  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">56</span>, <span class="dv">47</span>, <span class="dv">45</span>, <span class="dv">46</span>, <span class="dv">49</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>g22  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">58</span>, <span class="dv">54</span>, <span class="dv">49</span>, <span class="dv">61</span>, <span class="dv">52</span>, <span class="dv">62</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a>g23  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">59</span>, <span class="dv">55</span>, <span class="dv">68</span>, <span class="dv">63</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>g31  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">43</span>, <span class="dv">56</span>, <span class="dv">48</span>, <span class="dv">46</span>, <span class="dv">47</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>g32  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">59</span>, <span class="dv">46</span>, <span class="dv">58</span>, <span class="dv">54</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>g33  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">69</span>, <span class="dv">63</span>, <span class="dv">56</span>, <span class="dv">62</span>, <span class="dv">67</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>dfMD &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">IV1=</span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>P, <span class="kw">c</span>(<span class="dv">3</span><span class="op">+</span><span class="dv">5</span><span class="op">+</span><span class="dv">7</span>, <span class="dv">5</span><span class="op">+</span><span class="dv">6</span><span class="op">+</span><span class="dv">4</span>, <span class="dv">5</span><span class="op">+</span><span class="dv">4</span><span class="op">+</span><span class="dv">6</span>))),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a>                   <span class="dt">IV2=</span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>Q, P), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>, <span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>, <span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>))),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>                   <span class="dt">DV =</span><span class="kw">c</span>(g11, g12, g13, g21, g22, g23, g31, g32, g33))</span></code></pre></div><div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>IV1 <span class="op">+</span><span class="st"> </span>IV2, <span class="dt">data=</span>dfMD)</span></code></pre></div><pre><code>   IV2
IV1 1 2 3
  1 3 5 7
  2 5 6 4
  3 5 4 6</code></pre><h2 id="ss-type-i-sequential-sum-of-squares">SS type I (sequential sum of squares)</h2><p>Type I sum of squares have the following properties:</p><ul><li>They use sequential model comparisons that conform to the principle of marginality (higher order terms are entered after all corresponding lower order terms).</li><li>Due to the sequential nature of the model comparisons, they depend on the order of model terms.</li><li>The individual effect SS sum to the total effect SS</li><li>They test for the equality of weighted marginal expected values (see above). -&gt; the hypotheses take the empirical cell sizes into account</li><li>They do not depend on the contrast coding scheme used for categorical variables.</li></ul><h3 id="factor-order-matters">Factor order matters</h3><div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1 <span class="op">+</span><span class="st"> </span>IV2 <span class="op">+</span><span class="st"> </span>IV1<span class="op">:</span>IV2, <span class="dt">data=</span>dfMD))</span></code></pre></div><pre><code>Analysis of Variance Table

Response: DV
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
IV1        2  101.11   50.56  1.8102    0.1782    
IV2        2 1253.19  626.59 22.4357 4.711e-07 ***
IV1:IV2    4   14.19    3.55  0.1270    0.9717    
Residuals 36 1005.42   27.93                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV2 <span class="op">+</span><span class="st"> </span>IV1 <span class="op">+</span><span class="st"> </span>IV1<span class="op">:</span>IV2, <span class="dt">data=</span>dfMD))</span></code></pre></div><pre><code>Analysis of Variance Table

Response: DV
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
IV2        2 1115.82  557.91 19.9764 1.458e-06 ***
IV1        2  238.48  119.24  4.2695   0.02168 *  
IV2:IV1    4   14.19    3.55  0.1270   0.97170    
Residuals 36 1005.42   27.93                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><h3 id="sequential-model-comparisons">Sequential model comparisons</h3><div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>SS.I1 &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,                 <span class="dt">data=</span>dfMD),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>               <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1,               <span class="dt">data=</span>dfMD))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>SS.I2 &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1,               <span class="dt">data=</span>dfMD),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>               <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2,           <span class="dt">data=</span>dfMD))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>SS.Ii &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2,           <span class="dt">data=</span>dfMD),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>               <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2 <span class="op">+</span><span class="st"> </span>IV1<span class="op">:</span>IV2, <span class="dt">data=</span>dfMD))</span></code></pre></div><div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a>SS.I1[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 101.1111</code></pre><div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a>SS.I2[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 1253.189</code></pre><div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a>SS.Ii[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 14.18714</code></pre><h3 id="total-ss-sum-of-effect-ss">Total SS <span class="math inline">\(=\)</span> sum of effect SS</h3><div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a>SST &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,       <span class="dt">data=</span>dfMD),</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>             <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">*</span>IV2, <span class="dt">data=</span>dfMD))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>SST[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 1368.487</code></pre><div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>SS.I1[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>] <span class="op">+</span><span class="st"> </span>SS.I2[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>] <span class="op">+</span><span class="st"> </span>SS.Ii[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 1368.487</code></pre><h2 id="ss-type-ii">SS type II</h2><p>Type II sum of squares have the following properties:</p><ul><li>They test model comparisons that conform to the principle of marginality.</li><li>They do not depend on the order of model terms.</li><li>They test hypotheses about weighted cell expected values (see above). -&gt; the hypotheses take the empirical cell sizes into account</li><li>The individual effect SS do not sum to the total effect SS.</li><li>The result does not depend on the coding scheme for categorical variables.</li></ul><h3 id="using-anova-from-package-car">Using <code>Anova()</code> from package <code>car</code></h3><div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">library</span>(car)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a><span class="kw">Anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">*</span>IV2, <span class="dt">data=</span>dfMD), <span class="dt">type=</span><span class="st">&quot;II&quot;</span>)</span></code></pre></div><pre><code>Anova Table (Type II tests)

Response: DV
           Sum Sq Df F value    Pr(&gt;F)    
IV1        238.48  2  4.2695   0.02168 *  
IV2       1253.19  2 22.4357 4.711e-07 ***
IV1:IV2     14.19  4  0.1270   0.97170    
Residuals 1005.42 36                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><h3 id="using-model-comparisons">Using model comparisons</h3><div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>SS.II1 &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st">     </span>IV2,         <span class="dt">data=</span>dfMD),</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>                <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2,         <span class="dt">data=</span>dfMD))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>SS.II2 &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1,             <span class="dt">data=</span>dfMD),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>                <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2,         <span class="dt">data=</span>dfMD))</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>SS.IIi &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2,         <span class="dt">data=</span>dfMD),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a>                <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">+</span>IV2<span class="op">+</span>IV1<span class="op">:</span>IV2, <span class="dt">data=</span>dfMD))</span></code></pre></div><div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a>SS.II1[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 238.4826</code></pre><div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a>SS.II2[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 1253.189</code></pre><div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a>SS.IIi[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 14.18714</code></pre><h3 id="total-ss-neq-sum-of-effect-ss">Total SS <span class="math inline">\(\neq\)</span> sum of effect SS</h3><div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a>SST &lt;-<span class="st"> </span><span class="kw">anova</span>(<span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,       <span class="dt">data=</span>dfMD),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>             <span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1<span class="op">*</span>IV2, <span class="dt">data=</span>dfMD))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>SST[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 1368.487</code></pre><div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a>SS.II1[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>] <span class="op">+</span><span class="st"> </span>SS.II2[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>] <span class="op">+</span><span class="st"> </span>SS.IIi[<span class="dv">2</span>, <span class="st">&quot;Sum of Sq&quot;</span>]</span></code></pre></div><pre><code>[1] 1505.859</code></pre><h2 id="ss-type-iii">SS type III</h2><p>Type III sum of squares have the following properties:</p><ul><li>They test model comparisons that violate the principle of marginality when testing main effects.</li><li>They do not depend on the order of model terms.</li><li>The individual effect SS do not sum to the total effect SS.</li><li>They test for the equality of unweighted marginal expected values (see above). -&gt; the hypotheses do not take empirical cell sizes into account</li><li>These hypotheses are only tested when using effect- or orthogonal coding for categorical variables (e.g., Helmert).</li></ul><h3 id="using-anova-from-package-car-1">Using <code>Anova()</code> from package <code>car</code></h3><div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co"># options(contrasts=c(unordered=&quot;contr.sum&quot;,       ordered=&quot;contr.poly&quot;))</span></span></code></pre></div><div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co"># options(contrasts=c(unordered=&quot;contr.treatment&quot;, ordered=&quot;contr.poly&quot;))</span></span></code></pre></div><div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a>fitIII &lt;-<span class="st"> </span><span class="kw">lm</span>(DV <span class="op">~</span><span class="st"> </span>IV1 <span class="op">+</span><span class="st"> </span>IV2 <span class="op">+</span><span class="st"> </span>IV1<span class="op">:</span>IV2, <span class="dt">data=</span>dfMD,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a>             <span class="dt">contrasts=</span><span class="kw">list</span>(<span class="dt">IV1=</span>contr.sum, <span class="dt">IV2=</span>contr.sum))</span></code></pre></div><div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a><span class="kw">library</span>(car)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a><span class="kw">Anova</span>(fitIII, <span class="dt">type=</span><span class="st">&quot;III&quot;</span>)</span></code></pre></div><pre><code>Anova Table (Type III tests)

Response: DV
            Sum Sq Df   F value    Pr(&gt;F)    
(Intercept) 121174  1 4338.7178 &lt; 2.2e-16 ***
IV1            205  2    3.6658   0.03556 *  
IV2           1181  2   21.1452 8.447e-07 ***
IV1:IV2         14  4    0.1270   0.97170    
Residuals     1005 36                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><h3 id="model-comparisons-using-drop1">Model comparisons using <code>drop1()</code></h3><p>The model comparisons for main effects with SS type III cannot be done using <code>anova()</code> due to the violation of marginality principle - <code>anova()</code> automatically includes all lower-order terms for the interactions it finds. This would be the comparison:</p><div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="co"># A: lm(DV ~     IV2 + IV1:IV2) vs. lm(DV ~ IV1 + IV2 + IV1:IV2)</span></span></code></pre></div><div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="co"># B: lm(DV ~ IV1     + IV1:IV2) vs. lm(DV ~ IV1 + IV2 + IV1:IV2)</span></span></code></pre></div><p>In contrast, <code>drop1()</code> drops each term in turn even if marginality is violated, so it gives SS type III.</p><div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="kw">drop1</span>(fitIII, <span class="op">~</span><span class="st"> </span>., <span class="dt">test=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div><pre><code>Single term deletions

Model:
DV ~ IV1 + IV2 + IV1:IV2
        Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
&lt;none&gt;               1005.4 157.79                      
IV1      2    204.76 1210.2 162.13  3.6658   0.03556 *  
IV2      2   1181.11 2186.5 188.75 21.1452 8.447e-07 ***
IV1:IV2  4     14.19 1019.6 150.42  0.1270   0.97170    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a><span class="kw">drop1</span>(fitIII, <span class="op">~</span><span class="st"> </span>., <span class="dt">test=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div><pre><code>Single term deletions

Model:
DV ~ IV1 + IV2 + IV1:IV2
        Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
&lt;none&gt;               1005.4 157.79                      
IV1      2    204.76 1210.2 162.13  3.6658   0.03556 *  
IV2      2   1181.11 2186.5 188.75 21.1452 8.447e-07 ***
IV1:IV2  4     14.19 1019.6 150.42  0.1270   0.97170    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre><h2 id="detach-automatically-loaded-packages-if-possible">Detach (automatically) loaded packages (if possible)</h2><div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="kw">try</span>(<span class="kw">detach</span>(package<span class="op">:</span>car))</span></code></pre></div><h2 id="get-the-article-source-from-github">Get the article source from GitHub</h2><p><a href="https://github.com/dwoll/RExRepos/raw/master/Rmd/anovaSStypes.Rmd">R markdown</a> - <a href="https://github.com/dwoll/RExRepos/raw/master/md/anovaSStypes.md">markdown</a> - <a href="https://github.com/dwoll/RExRepos/raw/master/R/anovaSStypes.R">R code</a> - <a href="https://github.com/dwoll/RExRepos/">all posts</a></p>
        </div> <!-- /col-sm-8 col-md-10 -->
      </div> <!--/row-->

      <div class="row">
        <div class="col toplink">
          <!-- ### toplink include starts ### -->
        <p class="toplink">
          <span class="toplink"><a href="#top"><img src="http://dwoll.de/rexrepos/content/assets/img/cup-sm.png" width=23 height=14 /> top</a></span>
        </p>
        <!-- ### toplink include ends ### -->

        </div> <!--/col-->
      </div> <!--/row-->

      <div class="row">
        <div class="col footer">
          <!-- ### footer include starts ### -->

<footer>
  &copy; 2020
  Daniel Wollschlaeger -
  
  licensed under CC-BY-SA <a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="http://dwoll.de/rexrepos/content/assets/img/cc-by-sa80x15.png" width="80" height="15" alt="Creative Commons BY-SA" /></a>
  
</footer>

<!-- ### footer include ends ### -->

        </div> <!-- /col footer -->
      </div> <!-- /row -->
    </div><!-- /container-fluid -->
<!-- ### bottom include starts ### -->
    <!-- ### JavaScript include starts ### -->
    <script src="http://dwoll.de/rexrepos/content/assets/js/bootstrap.bundle.min.js"></script>
    <script>
    MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }};
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <!-- ### JavaScript include ends ### -->

  </body>
</html>

