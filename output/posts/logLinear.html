<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Log-linear models</title>
    <meta name="author" content="Daniel Wollschlaeger">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="http://dwoll.de/rexrepos/content/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="http://dwoll.de/rexrepos/content/assets/css/style.css" rel="stylesheet" type="text/css" media="all">
    <link href="http://dwoll.de/rexrepos/content/assets/css/syntax.css" rel="stylesheet" type="text/css" media="all">
  </head>

  <body>
    <!-- ### navbar include starts ### -->
    <nav class="navbar navbar-expand-md fixed-top bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="http://dwoll.de/rexrepos/index.html">RExRepos</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      
    
      <!-- Everything you want hidden at 940px or less, place within here -->
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown0" role="button" aria-expanded="false">R Basics</a>
            <div class="dropdown-menu" aria-labelledby="dropdown0">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerR_Basics.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/gui.html">R user interfaces</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/helpDocs.html">Getting help and documentation</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/workspace.html">Exploring the workspace</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/packages.html">Add-on packages</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/arithmeticLogic.html">Arithmetic and logic</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/vector.html">Vectors</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/generateData.html">Generate systematic and random data</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/transformData.html">Variable transformations</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/recode.html">Recode variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/factors.html">Factors</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/sets.html">Sets</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/combinatorics.html">Combinatorics</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/matrix.html">Matrices</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/strings.html">Character strings</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/timeDate.html">Time and date</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown1" role="button" aria-expanded="false">Descriptive</a>
            <div class="dropdown-menu" aria-labelledby="dropdown1">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerDescriptive.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/sumProdRange.html">Sum, product, and range of data</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/mean.html">The mean and other location measures</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/variance.html">Variance, robust spread measures, skewness, and kurtosis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/correlation.html">Covariance, correlation, association for continuous variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/matrixStatistics.html">Descriptive statistics for data in matrices</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/frequencies.html">Frequency tables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/association.html">Association for unordered categorical variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/associationOrder.html">Association for ordered categorical variables</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/interRaterICC.html">Inter-rater-reliability and intra-class-correlation</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/aggregate.html">Aggregate data vectors by group</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/missingData.html">Deal with missing data</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown2" role="button" aria-expanded="false">Data Frames</a>
            <div class="dropdown-menu" aria-labelledby="dropdown2">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerData_Frames.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dataFrames.html">Create and analyze data frames</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfImportExport.html">Data import and export</a>
                  
                    <div class="nav-header">Data wrangling base R</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfTransform.html">Choose names, variables, cases</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfSplitMerge.html">Split and combine data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfReshape.html">Reshape data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfAggregate.html">Aggregate data frames</a>
                    
                    <div class="nav-header">Data wrangling dplyr tidyr</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfTransform_tidy.html">Choose names, variables, cases</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfSplitMerge_tidy.html">Split and combine data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfReshape_tidy.html">Reshape data frames</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/dfAggregate_tidy.html">Aggregate data frames</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown active">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown3" role="button" aria-expanded="false">Univariate</a>
            <div class="dropdown-menu" aria-labelledby="dropdown3">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerUnivariate.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <div class="nav-header">Regression Models</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regression.html">Multiple linear regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionRobPen.html">Robust and penalized regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionModMed.html">Moderation and mediation</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionLogistic.html">Logistic regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionOrdinal.html">Ordinal regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionMultinom.html">Multinomial regression</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionPoisson.html">Poisson regression</a>
                    
                      <a class="dropdown-item active" href="http://dwoll.de/rexrepos/posts/logLinear.html">Log-linear models</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/regressionDiag.html">Regression diagnostics</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/crossvalidation.html">Crossvalidation</a>
                    
                    <div class="nav-header">Survival analysis</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/survivalKM.html">Kaplan-Meier-estimate</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/survivalCoxPH.html">Cox proportional hazards</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/survivalParametric.html">Parametric proportional hazards</a>
                    
                    <div class="nav-header">t Tests</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/tTest.html">t-tests</a>
                    
                    <div class="nav-header">ANOVA</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaCRp.html">One-way ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaCRFpq.html">Two-way ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/ancova.html">Analysis of covariance</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaRBp.html">One-way repeated-measures ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaRBFpq.html">Two-way repeated-measures ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaSPFpq.html">Two-way split-plot ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaSPFpqr.html">Three-way split-plot ANOVA</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaMixed.html">Mixed effects models</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/anovaSStypes.html">Sum of squares type I, II, and III</a>
                    
                    <div class="nav-header">General Topics</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/normality.html">Assess normality</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/varianceHom.html">Assess variance homogeneity</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown4" role="button" aria-expanded="false">Nonparametric</a>
            <div class="dropdown-menu" aria-labelledby="dropdown4">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerNonparametric.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <div class="nav-header">Classical nonparametric tests</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npWilcoxon.html">Location 1,2 groups (Sign, Wilcoxon signed-rank, Wilcoxon-Mann-Whitney)</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npKruskalFriedman.html">Location 3+ groups (Kruskal-Wallis, linear-by-linear, Friedman, Page)</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npBinomial.html">Binomial and chi^2 for proportions</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npRuns.html">Runs</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/association.html">Association for unordered categorical variables</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/associationOrder.html">Association for ordered categorical variables</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npCochran.html">Cochran-Q</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npBowker.html">Bowker</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npMcNemar.html">McNemar</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/npStuartMaxwell.html">Stuart-Maxwell for marginal homogeneity</a>
                    
                    <div class="nav-header">Resampling methods</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingPerm.html">Permutation tests</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBoot.html">Nonparametric bootstrapping</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBootStrat.html">Stratified nonparametric bootstrapping</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBootALM.html">Nonparametric bootstrapping linear models</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/resamplingBootParam.html">Parametric bootstrapping</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown5" role="button" aria-expanded="false">Multivariate</a>
            <div class="dropdown-menu" aria-labelledby="dropdown5">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerMultivariate.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/linearAlgebra.html">Linear algebra calculations</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multPCA.html">Principal components analysis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multFA.html">Factor analysis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multFApoly.html">Factor analysis for ordinal data</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multMDS.html">Multidimensional scaling</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multRegression.html">Multivariate multiple regression</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multHotelling.html">Hotelling's T^2-test</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multMANOVA.html">Multivariate analysis of variance</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/multLDA.html">Linear discriminant analysis</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/normality.html">Assess multivariate normality</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown6" role="button" aria-expanded="false">Diagrams</a>
            <div class="dropdown-menu" aria-labelledby="dropdown6">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerDiagrams.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <div class="nav-header">Diagram basics</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagDevice.html">Graphics devices</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagScatter.html">Scatter plots and line diagrams</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagFormat.html">Customize diagrams: Formatting</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagAddElements.html">Customize diagrams: Add elements</a>
                    
                    <div class="nav-header">Specific diagrams</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagCategorical.html">Diagrams for categorical data</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagDistributions.html">Visualize univariate and bivariate distributions</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagMultivariate.html">Diagrams for multivariate data</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagBounding.html">Convex hull, (minimum) bounding box, minimum enclosing ellipse, and minimum enclosing circle</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagSplines.html">Linear interpolation, polynomial smoothing, and splines</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagMultiple.html">Multiple diagrams per graphics device</a>
                    
                    <div class="nav-header">Diagrams ggplot2</div>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagGgplot_types.html">Diagram types with the ggplot2 package</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagGgplot_aes.html">Color, line type, and point shape in ggplot2 diagrams</a>
                    
                      <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/diagGgplot_format.html">Format ggplot2 diagrams</a>
                    
            </div> <!-- /dropdown-menu -->
          </li>
          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown7" role="button" aria-expanded="false">Numerical</a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown7">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerNumerical.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/numRoot.html">Root finding</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/numIntegrate.html">Numerical integration and differentiation</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/numOptimize.html">Numerical optimization</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
        </ul>
        <ul class="navbar-nav ml-auto">
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" id="dropdown8" role="button" aria-expanded="false">Workflow</a>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdown8">
              <a class="dropdown-item" href="http://dwoll.de/rexrepos/rerWorkflow.html">Overview</a>
              <div class="dropdown-divider"></div>
              
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/rerWorkflowJN.html">Build websites with R and nanoc or Jekyll</a>
                  
                    <a class="dropdown-item" href="http://dwoll.de/rexrepos/posts/rerWorkflowWP.html">Build websites with R and WordPress</a>
                  
            </div> <!-- /dropdown-menu -->
          </li>
          
        </ul>
      </div> <!-- /navbar-collapse -->
    </div> <!-- /container-fluid -->
    </nav>
    <!-- ### navbar include ### ends -->

    <div class="container-fluid" id="top">
      <div class="row">
      <!-- ### top include ends ### -->

        <div class="col-sm-4 col-md-2 dw_sidebar">
          <!-- ### rerPostList include starts ### -->

<ul class="nav flex-column">

<li class="nav-header">Regression Models</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regression.html">Multiple linear regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionRobPen.html">Robust and penalized regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionModMed.html">Moderation and mediation</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionLogistic.html">Logistic regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionOrdinal.html">Ordinal regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionMultinom.html">Multinomial regression</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionPoisson.html">Poisson regression</a></li>

<li class="nav-item"><a class="nav-link active" href="http://dwoll.de/rexrepos/posts/logLinear.html">Log-linear models</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/regressionDiag.html">Regression diagnostics</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/crossvalidation.html">Crossvalidation</a></li>


<li class="nav-header">Survival analysis</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/survivalKM.html">Kaplan-Meier-estimate</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/survivalCoxPH.html">Cox proportional hazards</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/survivalParametric.html">Parametric proportional hazards</a></li>


<li class="nav-header">t Tests</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/tTest.html">t-tests</a></li>


<li class="nav-header">ANOVA</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaCRp.html">One-way ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaCRFpq.html">Two-way ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/ancova.html">Analysis of covariance</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaRBp.html">One-way repeated-measures ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaRBFpq.html">Two-way repeated-measures ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaSPFpq.html">Two-way split-plot ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaSPFpqr.html">Three-way split-plot ANOVA</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaMixed.html">Mixed effects models</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/anovaSStypes.html">Sum of squares type I, II, and III</a></li>


<li class="nav-header">General Topics</li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/normality.html">Assess normality</a></li>

<li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/posts/varianceHom.html">Assess variance homogeneity</a></li>


</ul>

<!-- ### rerPostList include ends ### -->

          <hr />
          <!-- ### rerCategTagList include starts ### -->
    <ul class="nav flex-column">
      <li class="dropdown-header">Tags</li>
      
      <li><ul class="nav nav-list">
        
        <li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/tags.html#Regression-ref">Regression</a></li>
        
        <li class="nav-item"><a class="nav-link" href="http://dwoll.de/rexrepos/tags.html#GLM-ref">GLM</a></li>
        
      </ul></li>
      
    </ul>
    <!-- ### rerCategTagList include ends ### -->

        </div> <!-- /col-sm-4 col-md-2 -->

        <div class="col-sm-8 col-md-10 dw_main">
          <h1>Log-linear models</h1>
          <div class="markdown-toc">
<ul><li><a href="#install-required-packages">Install required packages</a></li><li><a href="#log-linear-model">Log-linear model</a><ul><li><a href="#data">Data</a></li><li><a href="#mosaic-plot-of-category-frequencies">Mosaic-plot of category frequencies</a></li><li><a href="#coefficient-estimates">Coefficient estimates</a></li><li><a href="#standard-errors-for-parameter-estimates">Standard errors for parameter estimates</a></li><li><a href="#convert-parameter-estimates-from-glm-and-loglm">Convert parameter estimates from <code>glm()</code> and <code>loglm()</code></a></li></ul></li><li><a href="#detach-automatically-loaded-packages-if-possible">Detach (automatically) loaded packages (if possible)</a></li><li><a href="#get-the-article-source-from-github">Get the article source from GitHub</a></li></ul>
</div>
<h2 id="install-required-packages">Install required packages</h2><p><a href="http://cran.r-project.org/package=MASS"><code>MASS</code></a></p><div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a>wants &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>has   &lt;-<span class="st"> </span>wants <span class="op">%in%</span><span class="st"> </span><span class="kw">rownames</span>(<span class="kw">installed.packages</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="cf">if</span>(<span class="kw">any</span>(<span class="op">!</span>has)) <span class="kw">install.packages</span>(wants[<span class="op">!</span>has])</span></code></pre></div><h2 id="log-linear-model">Log-linear model</h2><h3 id="data">Data</h3><p><code>UCBAdmissions</code> is a built-in <span class="math inline">\((2 \times 2 \times 6)\)</span> contingency table.</p><div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">library</span>(MASS)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">str</span>(UCBAdmissions)</span></code></pre></div><pre><code> table [1:2, 1:2, 1:6] 512 313 89 19 353 207 17 8 120 205 ...
 - attr(*, &quot;dimnames&quot;)=List of 3
  ..$ Admit : chr [1:2] &quot;Admitted&quot; &quot;Rejected&quot;
  ..$ Gender: chr [1:2] &quot;Male&quot; &quot;Female&quot;
  ..$ Dept  : chr [1:6] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...</code></pre><p>Test model of complete independence (= full additivity) based on data in a contingency table.</p><div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a>(llFit &lt;-<span class="st"> </span><span class="kw">loglm</span>(<span class="op">~</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept <span class="op">+</span><span class="st"> </span>Gender, <span class="dt">data=</span>UCBAdmissions))</span></code></pre></div><pre><code>Call:
loglm(formula = ~Admit + Dept + Gender, data = UCBAdmissions)

Statistics:
                      X^2 df P(&gt; X^2)
Likelihood Ratio 2097.671 16        0
Pearson          2000.328 16        0</code></pre><p>Test the same model based on data in a data frame with variable <code>Freq</code> as the observed category frequencies.</p><div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>UCBAdf &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(UCBAdmissions)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">loglm</span>(Freq <span class="op">~</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept <span class="op">+</span><span class="st"> </span>Gender, <span class="dt">data=</span>UCBAdf)</span></code></pre></div><pre><code>Call:
loglm(formula = Freq ~ Admit + Dept + Gender, data = UCBAdf)

Statistics:
                      X^2 df P(&gt; X^2)
Likelihood Ratio 2097.671 16        0
Pearson          2000.328 16        0</code></pre><p>Specific model of conditional independence.</p><div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">loglm</span>(<span class="op">~</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept <span class="op">+</span><span class="st"> </span>Gender <span class="op">+</span><span class="st"> </span>Admit<span class="op">:</span>Dept <span class="op">+</span><span class="st"> </span>Dept<span class="op">:</span>Gender, <span class="dt">data=</span>UCBAdmissions)</span></code></pre></div><pre><code>Call:
loglm(formula = ~Admit + Dept + Gender + Admit:Dept + Dept:Gender, 
    data = UCBAdmissions)

Statistics:
                      X^2 df    P(&gt; X^2)
Likelihood Ratio 21.73551  6 0.001351993
Pearson          19.93841  6 0.002840164</code></pre><h3 id="mosaic-plot-of-category-frequencies">Mosaic-plot of category frequencies</h3><div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">mosaicplot</span>(<span class="op">~</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept <span class="op">+</span><span class="st"> </span>Gender, <span class="dt">shade=</span><span class="ot">TRUE</span>, <span class="dt">data=</span>UCBAdmissions)</span></code></pre></div><figure><img src="../content/assets/figure/rerLogLinear01-1.png" alt="" /><figcaption>plot of chunk rerLogLinear01</figcaption></figure><h3 id="coefficient-estimates">Coefficient estimates</h3><p><code>coef(loglm(...))</code> automatically uses effect coding.</p><div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>(llCoef &lt;-<span class="st"> </span><span class="kw">coef</span>(llFit))</span></code></pre></div><pre><code>$`(Intercept)`
[1] 5.177567

$Admit
  Admitted   Rejected 
-0.2283697  0.2283697 

$Gender
      Male     Female 
 0.1914342 -0.1914342 

$Dept
          A           B           C           D           E           F 
 0.23047857 -0.23631478  0.21427076  0.06663476 -0.23802565 -0.03704367 </code></pre><div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="kw">exp</span>(llCoef<span class="op">$</span>Gender)</span></code></pre></div><pre><code>    Male   Female 
1.210985 0.825774 </code></pre><h3 id="standard-errors-for-parameter-estimates">Standard errors for parameter estimates</h3><p>Get standard errors for parameter estimates from fitting the corresponding Poisson-regression with <code>glm()</code> - default with treatment coding.</p><div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a>glmFitT &lt;-<span class="st"> </span><span class="kw">glm</span>(Freq <span class="op">~</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept <span class="op">+</span><span class="st"> </span>Gender, <span class="dt">family=</span><span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>), <span class="dt">data=</span>UCBAdf)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="kw">coef</span>(<span class="kw">summary</span>(glmFitT))</span></code></pre></div><pre><code>                 Estimate Std. Error     z value     Pr(&gt;|z|)
(Intercept)    5.37110984 0.03963977 135.4980063 0.000000e+00
AdmitRejected  0.45673941 0.03050686  14.9716962 1.124171e-50
DeptB         -0.46679335 0.05273601  -8.8515102 8.634289e-19
DeptC         -0.01620781 0.04648785  -0.3486461 7.273550e-01
DeptD         -0.16384381 0.04831585  -3.3910984 6.961310e-04
DeptE         -0.46850422 0.05276479  -8.8791074 6.739899e-19
DeptF         -0.26752224 0.04972276  -5.3802772 7.437123e-08
GenderFemale  -0.38286839 0.03027464 -12.6465054 1.169626e-36</code></pre><div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># glm() fitted values are the same as loglm() ones</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a><span class="kw">all.equal</span>(<span class="kw">c</span>(<span class="kw">fitted</span>(llFit)), <span class="kw">fitted</span>(glmFitT), <span class="dt">check.attributes=</span><span class="ot">FALSE</span>)</span></code></pre></div><pre><code>Re-fitting to get fitted values</code></pre><pre><code>[1] TRUE</code></pre><h3 id="convert-parameter-estimates-from-glm-and-loglm">Convert parameter estimates from <code>glm()</code> and <code>loglm()</code></h3><p>With <code>glm()</code>, the default coding scheme for categorical variables is treatment coding where the first group in a factor is the reference level, and the respective parameter of each remaining group is its difference to this reference. The (Intercept) estimate is for the cell with all groups = reference level for their factor. <code>glm()</code> does not list those parameter estimates that are fully determined (aliased) through the sum-to-zero constraint for the parameters for one factor.</p><p>With <code>loglm()</code>, the parameters are for deviation coding, meaning that each group gets its own parameter, and the parameters for one factor sum to zero. (Intercept) is the grand mean that gets added to all group effects.</p><p>Effect coding coefficient estimates from <code>loglm()</code> can be converted to treatment coding estimates from <code>glm()</code>.</p><div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a>(glmTcoef &lt;-<span class="st"> </span><span class="kw">coef</span>(glmFitT))</span></code></pre></div><pre><code>  (Intercept) AdmitRejected         DeptB         DeptC         DeptD 
   5.37110984    0.45673941   -0.46679335   -0.01620781   -0.16384381 
        DeptE         DeptF  GenderFemale 
  -0.46850422   -0.26752224   -0.38286839 </code></pre><div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>glmTcoef[<span class="st">&quot;(Intercept)&quot;</span>]</span></code></pre></div><pre><code>(Intercept) 
    5.37111 </code></pre><div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>llCoef<span class="op">$</span><span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>llCoef<span class="op">$</span>Admit[<span class="st">&quot;Admitted&quot;</span>] <span class="op">+</span><span class="st"> </span>llCoef<span class="op">$</span>Gender[<span class="st">&quot;Male&quot;</span>]  <span class="op">+</span><span class="st"> </span>llCoef<span class="op">$</span>Dept[<span class="st">&quot;A&quot;</span>]</span></code></pre></div><pre><code>Admitted 
 5.37111 </code></pre><div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>glmTcoef[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span>glmTcoef[<span class="st">&quot;DeptC&quot;</span>] <span class="op">+</span><span class="st"> </span>glmTcoef[<span class="st">&quot;GenderFemale&quot;</span>]</span></code></pre></div><pre><code>(Intercept) 
   4.972034 </code></pre><div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>llCoef<span class="op">$</span><span class="st">`</span><span class="dt">(Intercept)</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>llCoef<span class="op">$</span>Admit[<span class="st">&quot;Admitted&quot;</span>] <span class="op">+</span><span class="st"> </span>llCoef<span class="op">$</span>Dept[<span class="st">&quot;C&quot;</span>] <span class="op">+</span><span class="st"> </span>llCoef<span class="op">$</span>Gender[<span class="st">&quot;Female&quot;</span>]</span></code></pre></div><pre><code>Admitted 
4.972034 </code></pre><p><code>glm()</code> can directly use effect coding to get the same paramter estimates as <code>loglm()</code>, but also standard errors.</p><div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a>glmFitE &lt;-<span class="st"> </span><span class="kw">glm</span>(Freq <span class="op">~</span><span class="st"> </span>Admit <span class="op">+</span><span class="st"> </span>Dept <span class="op">+</span><span class="st"> </span>Gender, <span class="dt">family=</span><span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>               <span class="dt">contrasts=</span><span class="kw">list</span>(<span class="dt">Admit=</span>contr.sum,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a>                               <span class="dt">Dept=</span>contr.sum,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>                             <span class="dt">Gender=</span>contr.sum), <span class="dt">data=</span>UCBAdf)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a><span class="kw">coef</span>(<span class="kw">summary</span>(glmFitE))</span></code></pre></div><pre><code>               Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)  5.17756677 0.01577888 328.132716 0.000000e+00
Admit1      -0.22836970 0.01525343 -14.971696 1.124171e-50
Dept1        0.23047857 0.03071783   7.503086 6.233240e-14
Dept2       -0.23631478 0.03699431  -6.387869 1.682136e-10
Dept3        0.21427076 0.03090740   6.932668 4.129780e-12
Dept4        0.06663476 0.03272311   2.036321 4.171810e-02
Dept5       -0.23802565 0.03702165  -6.429363 1.281395e-10
Gender1      0.19143420 0.01513732  12.646505 1.169626e-36</code></pre><h2 id="detach-automatically-loaded-packages-if-possible">Detach (automatically) loaded packages (if possible)</h2><div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">try</span>(<span class="kw">detach</span>(package<span class="op">:</span>MASS))</span></code></pre></div><h2 id="get-the-article-source-from-github">Get the article source from GitHub</h2><p><a href="https://github.com/dwoll/RExRepos/raw/master/Rmd/logLinear.Rmd">R markdown</a> - <a href="https://github.com/dwoll/RExRepos/raw/master/md/logLinear.md">markdown</a> - <a href="https://github.com/dwoll/RExRepos/raw/master/R/logLinear.R">R code</a> - <a href="https://github.com/dwoll/RExRepos/">all posts</a></p>
        </div> <!-- /col-sm-8 col-md-10 -->
      </div> <!--/row-->

      <div class="row">
        <div class="col toplink">
          <!-- ### toplink include starts ### -->
        <p class="toplink">
          <span class="toplink"><a href="#top"><img src="http://dwoll.de/rexrepos/content/assets/img/cup-sm.png" width=23 height=14 /> top</a></span>
        </p>
        <!-- ### toplink include ends ### -->

        </div> <!--/col-->
      </div> <!--/row-->

      <div class="row">
        <div class="col footer">
          <!-- ### footer include starts ### -->

<footer>
  &copy; 2020
  Daniel Wollschlaeger -
  
  licensed under CC-BY-SA <a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="http://dwoll.de/rexrepos/content/assets/img/cc-by-sa80x15.png" width="80" height="15" alt="Creative Commons BY-SA" /></a>
  
</footer>

<!-- ### footer include ends ### -->

        </div> <!-- /col footer -->
      </div> <!-- /row -->
    </div><!-- /container-fluid -->
<!-- ### bottom include starts ### -->
    <!-- ### JavaScript include starts ### -->
    <script src="http://dwoll.de/rexrepos/content/assets/js/bootstrap.bundle.min.js"></script>
    <script>
    MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }};
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <!-- ### JavaScript include ends ### -->

  </body>
</html>

